import{r as b,b as n,c as p,d as a,m,n as w,f as g,k as U,C as D,D as C,p as c,v as h,F as k,h as T,e as B,t as _}from"./index-eb6767bb.js";import{S,N as q,F as A}from"./Footer-a92233b1.js";import{a as u,S as H}from"./sweetalert2.all-d8794e5f.js";import{P as y,D as L}from"./jquery.dataTables-6e53e4b4.js";import{Q as f}from"./quill.snow-07f1e52c.js";const O={id:"wrapper"},x={id:"content-wrapper",class:"d-flex flex-column"},M={id:"content"},N={class:"container-fluid my-4"},j={class:"row m-1"},P={class:"card p-3",style:{"border-radius":"25px"}},V=T('<div class="row mb-3"><div class="col-6"><div class="h5 font-weight-bold text-black">Harga</div></div><div class="d-flex justify-content-end col-6"><button class="btn btn-primary me-2" data-toggle="modal" data-target="#addData"><i class="bi bi-plus"></i> Tambah </button></div><div class="col-8"></div></div>',1),I={class:"table-responsive"},E={key:0,class:"preloader"},F=a("thead",null,[a("tr",null,[a("th",{scope:"col",style:{width:"50px"}},"No"),a("th",{scope:"col"},"Aksi"),a("th",{scope:"col"},"Nama Paket"),a("th",{scope:"col"},"Harga"),a("th",{scope:"col"},"Isi Paket")])],-1),z=["onClick"],K=a("i",{class:"bi bi-pencil-square"},null,-1),J=[K],Q=["onClick"],R=a("i",{class:"bi bi-trash3-fill"},null,-1),W=[R],G=["innerHTML"],X={class:"modal fade",id:"addData",tabindex:"-1",role:"dialog","aria-labelledby":"addDataLabel","aria-hidden":"true"},Y={class:"modal-dialog",role:"document"},Z={class:"modal-content"},aa=a("div",{class:"modal-header"},[a("h5",{class:"modal-title",id:"addDataLabel"},"Tambah Data"),a("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close"},[a("span",{"aria-hidden":"true"},"×")])],-1),ta={class:"modal-body"},ea={class:"form-group"},sa=a("label",{for:"nama_paket"},"Nama Paket",-1),oa={class:"form-group"},ia=a("label",{for:"harga"},"Harga",-1),ra=a("div",{class:"form-group"},[a("label",{for:"isi"},"Isi Paket"),a("div",{id:"isi_create_editor",style:{height:"200px"}})],-1),da={class:"modal-footer"},na=a("button",{type:"button",class:"btn btn-secondary","data-dismiss":"modal"}," Batal ",-1),la={class:"modal fade",id:"dataUpdate",tabindex:"-1",role:"dialog","aria-labelledby":"dataUpdateLabel","aria-hidden":"true"},pa={class:"modal-dialog",role:"document"},ca={class:"modal-content"},ha=a("div",{class:"modal-header"},[a("h5",{class:"modal-title",id:"dataUpdateLabel"},"Update Data"),a("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close"},[a("span",{"aria-hidden":"true"},"×")])],-1),ua={class:"modal-body"},ma={class:"form-group"},_a=a("label",{for:"nama_paket"},"Nama Paket",-1),ba={class:"form-group"},ga=a("label",{for:"harga"},"Harga",-1),ka=a("div",{class:"form-group"},[a("label",{for:"isi"},"Isi Paket"),a("div",{id:"isi_update_editor",style:{height:"200px"}})],-1),fa={class:"modal-footer"},ya=a("button",{type:"button",class:"btn btn-secondary","data-dismiss":"modal"}," Batal ",-1);y.use(L);const va={data(){return{dataList:[],tableOptions:{pagingType:"full_numbers"},dataCreate:{nama_paket:"",isi_paket:"",harga:""},dataUpdate:{id:"",nama_paket:"",isi_paket:"",harga:""},ready:!1}},mounted(){this.quillCreate=new f("#isi_create_editor",{theme:"snow",placeholder:"Masukkan isi",modules:{toolbar:[[{header:"1"},{header:"2"},{font:[]}],[{list:"ordered"},{list:"bullet"}],[{script:"sub"},{script:"super"}],[{align:[]}],["bold","italic","underline"],["link"],["blockquote","code-block"],[{color:[]},{background:[]}]]}}),this.quillCreate.on("text-change",()=>{this.dataCreate.isi_paket=this.quillCreate.root.innerHTML}),this.quillUpdate=new f("#isi_update_editor",{theme:"snow",placeholder:"Masukkan isi",modules:{toolbar:[[{header:"1"},{header:"2"},{font:[]}],[{list:"ordered"},{list:"bullet"}],[{script:"sub"},{script:"super"}],[{align:[]}],["bold","italic","underline"],["link"],["blockquote","code-block"],[{color:[]},{background:[]}]]}}),this.quillUpdate.on("text-change",()=>{this.dataUpdate.isi_paket=this.quillUpdate.root.innerHTML})},methods:{setDataUpdate(t,e,i,d){this.dataUpdate.id=t,this.dataUpdate.nama_paket=e,this.dataUpdate.isi_paket=i,this.quillUpdate.root.innerHTML=this.dataUpdate.isi_paket,this.dataUpdate.harga=d},async sendUpdateData(){try{const t=new FormData;t.append("nama_paket",this.dataUpdate.nama_paket),t.append("isi_paket",this.dataUpdate.isi_paket),t.append("harga",this.dataUpdate.harga);const e=await u.post(`https://apikyu.instinctechsolution.com/api/harga/update/${this.dataUpdate.id}`,t,{headers:{Authorization:`Bearer ${sessionStorage.getItem("token")}`}});console.log(e.data),this.dataUpdate={id:"",nama_paket:"",isi_paket:"",harga:""},this.quillUpdate.setContents([]),this.fetchData(),this.showAlert("Berhasil!","Data berhasil diupdate.","success")}catch(t){if(console.error(t),t.response&&t.response.data&&t.response.data.errors){const e=t.response.data.errors;let i=`Terjadi kesalahan:
`;for(let d in e)e.hasOwnProperty(d)&&(i+=`${e[d].join(", ")}
`);this.showError("Opps...",i,"error")}else this.showError("Opps...","Terjadi kesalahan saat menambahkan data.","error")}},async tambahData(){try{const t=new FormData;t.append("nama_paket",this.dataCreate.nama_paket),t.append("isi_paket",this.dataCreate.isi_paket),t.append("harga",this.dataCreate.harga);const e=await u.post("https://apikyu.instinctechsolution.com/api/harga/create",t,{headers:{Authorization:`Bearer ${sessionStorage.getItem("token")}`}});console.log(e.data),this.dataCreate={nama_paket:"",isi_paket:"",harga:""},this.quillCreate.setContents([]),this.fetchData(),this.showAlert("Berhasil!","Data berhasil ditambahkan.","success")}catch(t){if(console.error(t),t.response&&t.response.data&&t.response.data.errors){const e=t.response.data.errors;let i=`Terjadi kesalahan:
`;for(let d in e)e.hasOwnProperty(d)&&(i+=`${e[d].join(", ")}
`);this.showError("Opps...",i,"error")}else this.showError("Opps...","Terjadi kesalahan saat menambahkan data catpers.","error")}},async fetchData(){this.ready=!1;try{const t=await u.get("https://apikyu.instinctechsolution.com/api/harga/list",{headers:{Authorization:`Bearer ${sessionStorage.getItem("token")}`}});this.dataList=t.data.data,this.ready=!0}catch(t){console.error(t),this.showAlert("Opps...","Terjadi kesalahan saat mengambil data.","error")}},showAlert(t,e,i){this.$swal({title:t,text:e,icon:i}).then(()=>{$("#addData").modal("hide"),$("#dataUpdate").modal("hide")})},showError(t,e,i){this.$swal({title:t,text:e,icon:i}).then(()=>{})},async deleteData(t){try{const e=await u.delete(`https://apikyu.instinctechsolution.com/api/harga/delete/${t}`,{headers:{Authorization:`Bearer ${sessionStorage.getItem("token")}`}});console.log(e.data),this.fetchData(),this.showAlert("Success","Data berhasil didelete","success")}catch(e){console.error(e),this.showAlert("Oops...","Terjadi kesalahan saat mendelete data","error")}},konfirmasi(t,e){H.fire({title:`Apakah Anda yakin ingin menghapus data ${e}?`,text:"Data akan dihapus jika anda menekan tombol Hapus.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#ee0405",cancelButtonColor:"#858796",confirmButtonText:"Hapus",cancelButtonText:"Batal"}).then(i=>{i.isConfirmed&&this.deleteData(t)})}},created(){const t=sessionStorage.getItem("token");if(t)try{const[e,i]=t.split("."),d=JSON.parse(atob(e)),o=atob(i),s=JSON.parse(atob(t.split(".")[1])).exp,l=new Date(s*1e3);console.log("Waktu Kedaluwarsa (UTC):",l.toUTCString()),new Date>l?(console.log("Keluar"),sessionStorage.removeItem("token"),this.$router.push("/login")):console.log("Aman"),this.fetchData()}catch(e){console.error("Error decoding token:",e),this.$router.push("/login")}else this.$router.push("/login")}},$a=Object.assign(va,{__name:"HargaView",setup(t){const e=b(!1),i=b(""),d=()=>{e.value=!e.value,i.value=e.value?"toggled":""};return(o,r)=>(n(),p(k,null,[a("div",O,[m(S,{class:w(i.value)},null,8,["class"]),a("div",x,[a("div",M,[m(q,{onToggleSidebar:d}),a("div",N,[a("div",j,[a("div",P,[V,a("div",I,[o.ready?g("",!0):(n(),p("div",E)),o.ready?(n(),U(C(y),{key:1,class:"display table table-striped",options:o.tableOptions},{default:D(()=>[F,a("tbody",null,[(n(!0),p(k,null,B(o.dataList,(s,l)=>(n(),p("tr",{key:s.id},[a("td",null,_(l+1),1),a("td",null,[a("button",{class:"btn btn-warning me-1 mb-1","data-toggle":"modal","data-target":"#dataUpdate",onClick:v=>o.setDataUpdate(s.id,s.nama_paket,s.isi_paket,s.harga)},J,8,z),a("button",{class:"btn btn-danger me-1 mb-1",onClick:v=>o.konfirmasi(s.id,s.nama_paket)},W,8,Q)]),a("td",null,_(s.nama_paket),1),a("td",null,"Rp. "+_(s.harga),1),a("td",null,[a("div",{innerHTML:s.isi_paket},null,8,G)])]))),128))])]),_:1},8,["options"])):g("",!0)])])])])]),m(A)])]),a("div",X,[a("div",Y,[a("div",Z,[aa,a("div",ta,[a("form",null,[a("div",ea,[sa,c(a("input",{type:"text",class:"form-control",id:"nama_paket","onUpdate:modelValue":r[0]||(r[0]=s=>o.dataCreate.nama_paket=s),placeholder:"Masukkan nama paket",required:""},null,512),[[h,o.dataCreate.nama_paket]])]),a("div",oa,[ia,c(a("input",{type:"text",class:"form-control",id:"harga","onUpdate:modelValue":r[1]||(r[1]=s=>o.dataCreate.harga=s),placeholder:"Masukkan harga",required:""},null,512),[[h,o.dataCreate.harga]])]),ra])]),a("div",da,[na,a("button",{type:"button",class:"btn btn-primary",onClick:r[2]||(r[2]=(...s)=>o.tambahData&&o.tambahData(...s))}," Kirim ")])])])]),a("div",la,[a("div",pa,[a("div",ca,[ha,a("div",ua,[a("form",null,[a("div",ma,[_a,c(a("input",{type:"text",class:"form-control",id:"nama_paket","onUpdate:modelValue":r[3]||(r[3]=s=>o.dataUpdate.nama_paket=s),required:""},null,512),[[h,o.dataUpdate.nama_paket]])]),a("div",ba,[ga,c(a("input",{type:"text",class:"form-control",id:"harga","onUpdate:modelValue":r[4]||(r[4]=s=>o.dataUpdate.harga=s),required:""},null,512),[[h,o.dataUpdate.harga]])]),ka])]),a("div",fa,[ya,a("button",{type:"button",class:"btn btn-danger",onClick:r[5]||(r[5]=(...s)=>o.sendUpdateData&&o.sendUpdateData(...s))}," Update ")])])])])],64))}});export{$a as default};
