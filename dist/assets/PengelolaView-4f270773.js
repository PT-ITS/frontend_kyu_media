import{_ as V,r as u,b as p,f as k,g as e,i as P,n as U,c as I,A as z,B as F,s as x,t as m,j as h,v as _,F as S,z as q,x as E,y as R}from"./index-ff3a5314.js";import{S as j}from"./Sidebar-f27aa015.js";import{N as J,F as K}from"./Footer-a99f178f.js";import{a as y}from"./axios-a342f982.js";import{S as B}from"./sweetalert2.all-ba5903e9.js";import{P as C,D as L}from"./jquery.dataTables-5bb2cc9b.js";const l=i=>(E("data-v-821d0932"),i=i(),R(),i),O={id:"wrapper"},M={id:"content-wrapper",class:"d-flex flex-column"},W={id:"content"},G={class:"container-fluid mt-4"},Q=l(()=>e("h1",{class:"mb-0 fw-bold customJudul"},"Pengelola",-1)),X=l(()=>e("p",null,"Semangat semoga harimu menyenangkan",-1)),Y={class:"customBox mt-3"},Z={class:"container-fluid"},ee=l(()=>e("div",{class:"row"},[e("div",{class:"col-sm-6 mb-3"},[e("h6",{class:"fw-bold pt-3",style:{"font-size":"20px"}}," Data Pengelola ")]),e("div",{class:"col-sm-6 d-flex justify-content-end my-3"})],-1)),ae={class:"table-responsive"},te=l(()=>e("thead",null,[e("tr",null,[e("th",{scope:"col"},"No"),e("th",{scope:"col"},"Aksi"),e("th",{scope:"col"},"Nama"),e("th",{scope:"col"},"Email"),e("th",{scope:"col"},"Alamat"),e("th",{scope:"col"},"Nomor Telepon")])],-1)),se={scope:"row"},oe=["onClick"],le=l(()=>e("i",{class:"bi bi-pencil-square"},null,-1)),ne=[le],ie=["onClick"],re=l(()=>e("i",{class:"bi bi-trash"},null,-1)),de=[re],ce={class:"modal fade",id:"updatePengguna",tabindex:"-1",role:"dialog","aria-labelledby":"updatePenggunaLabel","aria-hidden":"true"},ue={class:"modal-dialog",role:"document"},me={class:"modal-content"},pe={class:"modal-header"},he={class:"modal-title",id:"updatePenggunaLabel"},_e=l(()=>e("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close"},[e("span",{"aria-hidden":"true"},"Ã—")],-1)),ve={class:"modal-body"},ge={class:"mb-3"},be=l(()=>e("label",{for:"name",class:"form-label"},"Nama Pengguna",-1)),fe={class:"mb-3"},ke=l(()=>e("label",{for:"email",class:"form-label"},"Email",-1)),we={key:0,class:"mb-3"},Pe=l(()=>e("label",{for:"password",class:"form-label"},"Password",-1)),ye={class:"mb-3"},xe=l(()=>e("label",{for:"alamat",class:"form-label"},"Alamat",-1)),Se={class:"mb-3"},Be=l(()=>e("label",{for:"noHP",class:"form-label"},"Nomor Telepon",-1)),$e=l(()=>e("button",{type:"button",class:"btn btn-secondary","data-dismiss":"modal"}," Batal ",-1)),Ce={created(){const i=sessionStorage.getItem("token");if(this.myToken=i,i)try{const[d,v]=i.split("."),g=JSON.parse(atob(d)),t=atob(v),n=JSON.parse(atob(i.split(".")[1])),r=n.exp,c=new Date(r*1e3);console.log("Waktu Kedaluwarsa (UTC):",c.toUTCString()),new Date>c?(console.log("Keluar"),sessionStorage.removeItem("token"),this.$router.push("/")):console.log("Aman");const w=n.level;this.user_id=n.id,console.log("ini idddd:",this.user_id),w!=="1"?this.$router.push("/unauthorized"):(!g||!t)&&this.$router.push("/")}catch(d){console.error("Error decoding token:",d),this.$router.push("/")}else this.$router.push("/")}},De=Object.assign(Ce,{__name:"PengelolaView",setup(i){C.use(L);const d=u(!1),v=u(""),g=u([]),t=u({id:"",name:"",email:"",alamat:"",noHP:"",password:""}),n=u(!1),r=u(!1),c=async()=>{try{const a=await y.get("https://api.surveiwisatadki.com/api/auth/list-pengelola",{headers:{Authorization:"Bearer "+sessionStorage.getItem("token")}});g.value=a.data.data,r.value=!0}catch(a){r.value=!0,console.error(a)}},w=a=>{t.value.id=a.id,t.value.name=a.name,t.value.email=a.email,t.value.alamat=a.alamat,t.value.noHP=a.noHP,t.value.password="",n.value=!0},D=async()=>{try{const a=new FormData;a.append("name",t.value.name),a.append("email",t.value.email),a.append("alamat",t.value.alamat),a.append("noHP",t.value.noHP),n.value||a.append("password",t.value.password);const o=n.value?`https://api.surveiwisatadki.com/api/auth/update/${t.value.id}`:"https://api.surveiwisatadki.com/api/auth/register",s=await y.post(o,a,{headers:{Authorization:"Bearer "+sessionStorage.getItem("token")}});c();const f=n.value?"diperbarui":"ditambahkan";b("Request Success",`Pengguna berhasil ${f}`,"success")}catch(a){const o=n.value?"diperbarui":"ditambahkan";b("Request Failed",`Pengguna gagal ${o}`,"error"),r.value=!0,console.error(a)}},T=(a,o)=>{B.fire({title:"Konfirmasi Penghapusan",text:`Apakah Anda yakin ingin menghapus pengguna ${o}?`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#061387",confirmButtonText:"Hapus",cancelButtonText:"Batal"}).then(s=>{s.isConfirmed&&H(a)})},H=async a=>{r.value=!1;try{await y.delete(`https://api.surveiwisatadki.com/api/auth/delete/${a}`,{headers:{Authorization:"Bearer "+sessionStorage.getItem("token")}}),b("Request Success","Pengguna berhasil dihapus","success"),c()}catch(o){b("Request Failed","Pengguna gagal dihapus","error"),console.error(o),r.value=!0}},b=(a,o,s)=>{B.fire({title:a,text:o,icon:s}).then(()=>{$("#updatePengguna").modal("hide")})},N=()=>{d.value=!d.value,v.value=d.value?"toggled":""};return c(),(a,o)=>(p(),k(S,null,[e("div",O,[P(j,{class:U(v.value)},null,8,["class"]),e("div",M,[e("div",W,[P(J,{onToggleSidebar:N}),e("div",G,[Q,X,e("div",Y,[e("div",Z,[ee,e("div",ae,[r.value?(p(),I(F(C),{key:0,class:"display table table-striped"},{default:z(()=>[te,e("tbody",null,[(p(!0),k(S,null,q(g.value,(s,f)=>(p(),k("tr",{key:f},[e("th",se,m(f+1),1),e("td",null,[e("button",{class:"btn btn-warning me-1",type:"button","data-toggle":"modal","data-target":"#updatePengguna",onClick:A=>w(s)},ne,8,oe),e("button",{class:"btn btn-danger",onClick:A=>T(s.id,s.name)},de,8,ie)]),e("td",null,m(s.name),1),e("td",null,m(s.email),1),e("td",null,m(s.alamat),1),e("td",null,m(s.noHP),1)]))),128))])]),_:1})):x("",!0)])])])])]),P(K)])]),e("div",ce,[e("div",ue,[e("div",me,[e("div",pe,[e("h5",he,m(n.value?"Update Data Pengguna":"Tambah Data Pengguna"),1),_e]),e("div",ve,[e("form",null,[e("div",ge,[be,h(e("input",{type:"text",class:"form-control",id:"name",placeholder:"masukkan nama pengguna","onUpdate:modelValue":o[0]||(o[0]=s=>t.value.name=s)},null,512),[[_,t.value.name]])]),e("div",fe,[ke,h(e("input",{type:"email",class:"form-control",id:"email",placeholder:"masukkan email pengguna","onUpdate:modelValue":o[1]||(o[1]=s=>t.value.email=s)},null,512),[[_,t.value.email]])]),n.value?x("",!0):(p(),k("div",we,[Pe,h(e("input",{type:"password",class:"form-control",id:"password",placeholder:"masukkan password","onUpdate:modelValue":o[2]||(o[2]=s=>t.value.password=s)},null,512),[[_,t.value.password]])])),e("div",ye,[xe,h(e("input",{type:"text",class:"form-control",id:"alamat",placeholder:"masukkan alamat pengguna","onUpdate:modelValue":o[3]||(o[3]=s=>t.value.alamat=s)},null,512),[[_,t.value.alamat]])]),e("div",Se,[Be,h(e("input",{type:"text",class:"form-control",id:"noHP",placeholder:"masukkan nomor telepon","onUpdate:modelValue":o[4]||(o[4]=s=>t.value.noHP=s)},null,512),[[_,t.value.noHP]])]),e("div",{class:"modal-footer"},[$e,e("button",{type:"button",class:"btn blueButton",onClick:D}," Simpan ")])])])])])])],64))}}),Ie=V(De,[["__scopeId","data-v-821d0932"]]);export{Ie as default};
