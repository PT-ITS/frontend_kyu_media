import{_ as M,L as w,b as f,f as g,r as h,H as R,g as a,i as S,n as z,s as C,c as K,A as q,B as J,j as r,v as d,F as x,z as O,t as b,x as W,y as G}from"./index-ff3a5314.js";import{S as Q}from"./Sidebar-f27aa015.js";import{N as X,F as Y}from"./Footer-a99f178f.js";import{S as V}from"./sweetalert2.all-ba5903e9.js";import{a as k}from"./axios-a342f982.js";import"./xlsx-6464457c.js";import"./leaflet.curve-0e7c6766.js";import{P as U,D as Z}from"./jquery.dataTables-5bb2cc9b.js";const aa={name:"LeafletMap",props:{defaultCoordinate:{type:String,required:!1,default:""}},data(){return{map:null,marker:null}},mounted(){if(this.map=w.map("mapContainerEdit"),w.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}).addTo(this.map),this.defaultCoordinate){const[l,i]=this.defaultCoordinate.split(",");this.map.setView([l,i],12),this.marker=w.marker([l,i]).addTo(this.map)}else navigator.geolocation?navigator.geolocation.getCurrentPosition(l=>{const i=l.coords.latitude,c=l.coords.longitude;this.map.setView([i,c],12),this.marker=w.marker([i,c]).addTo(this.map),this.$emit("location-selected",`${i},${c}`)},()=>{this.map.setView([-6.2088,106.8456],12),this.$emit("location-selected",`${-6.2088},${106.8456}`)}):(this.map.setView([-6.2088,106.8456],12),this.$emit("location-selected",`${-6.2088},${106.8456}`));this.map.on("click",this.onMapClick)},methods:{onMapClick(l){this.$emit("location-selected",`${l.latlng.lat},${l.latlng.lng}`),this.marker&&this.map.removeLayer(this.marker),this.marker=w.marker(l.latlng).addTo(this.map)}},beforeUnmount(){this.map&&this.map.remove()}},ea={id:"mapContainerEdit"};function ta(l,i,c,y,_,s){return f(),g("div",ea)}const oa=M(aa,[["render",ta],["__scopeId","data-v-fdd25177"]]);const n=l=>(W("data-v-308fe23b"),l=l(),G(),l),sa={id:"wrapper"},la={id:"content-wrapper",class:"d-flex flex-column"},na={id:"content"},ia={class:"container-fluid mt-4"},ra=n(()=>a("h1",{class:"mb-0 fw-bold customJudul"},"Rekapitulasi",-1)),da=n(()=>a("p",null,"Semangat semoga harimu menyenangkan",-1)),ca={class:"customBox mt-3"},ua={class:"container-fluid"},pa=n(()=>a("div",{class:"col-sm-6 mb-3"},[a("h6",{class:"fw-bold pt-3",style:{"font-size":"20px"}}," Rekapitulasi Data ")],-1)),ma={class:"table-responsive"},ha={key:0,class:"loading-container"},ba=n(()=>a("span",{class:"loading-text"},"Loading ...",-1)),ka=[ba],fa=n(()=>a("thead",null,[a("tr",null,[a("th",{scope:"col"},"No"),a("th",{scope:"col"},"Aksi"),a("th",{scope:"col"},"NIB"),a("th",{scope:"col"},"Nama"),a("th",{scope:"col"},"Alamat"),a("th",{scope:"col"},"Jenis"),a("th",{scope:"col"},"Penanggung Jawab"),a("th",{scope:"col"},"Nomor Telepon")])],-1)),_a={scope:"row"},ga=["onClick"],va=n(()=>a("i",{class:"bi bi-pencil-square"},null,-1)),wa=[va],ya=["onClick"],$a=n(()=>a("i",{class:"bi bi-trash"},null,-1)),Pa=[$a],ja=["onClick"],Sa=["onClick"],Ca=["onClick"],xa=["onClick"],Va=["onClick"],Ma=["onClick"],Ua={class:"modal fade",id:"updateModal",tabindex:"-1",role:"dialog","aria-labelledby":"updateModalLabel","aria-hidden":"true"},Da={class:"modal-dialog",role:"document"},Ba={class:"modal-content"},La=n(()=>a("div",{class:"modal-header"},[a("h5",{class:"modal-title",id:"updateModalLabel"},"Update Data"),a("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close"},[a("span",{"aria-hidden":"true"},"Ã—")])],-1)),Ha={class:"modal-body"},Ta={class:"mb-3"},Na=n(()=>a("label",{for:"nib",class:"form-label"},"NIB",-1)),Ia={class:"mb-3"},Aa=n(()=>a("label",{for:"nama",class:"form-label"},"Nama",-1)),Ea={class:"mb-3"},Fa=n(()=>a("label",{for:"resiko",class:"form-label"},"Resiko",-1)),Ra={class:"mb-3"},za=n(()=>a("label",{for:"skalaUsaha",class:"form-label"},"Skala Usaha",-1)),Ka={class:"mb-3"},qa=n(()=>a("label",{for:"alamat",class:"form-label"},"Alamat",-1)),Ja={key:0},Oa={class:"mb-3"},Wa=n(()=>a("label",{for:"bintangHotel",class:"form-label"},"Bintang Hotel",-1)),Ga={class:"mb-3"},Qa=n(()=>a("label",{for:"kamarVip",class:"form-label"},"Kamar VIP",-1)),Xa={class:"mb-3"},Ya=n(()=>a("label",{for:"kamarStandart",class:"form-label"},"Kamar Standard",-1)),Za={class:"mb-3"},ae=n(()=>a("label",{for:"namaPj",class:"form-label"},"Penanggung Jawab",-1)),ee={class:"mb-3"},te=n(()=>a("label",{for:"emailPj",class:"form-label"},"Email",-1)),oe={class:"mb-3"},se=n(()=>a("label",{for:"passwordPj",class:"form-label"},"Password",-1)),le={class:"mb-3"},ne=n(()=>a("label",{for:"teleponPj",class:"form-label"},"Nomor Telepon",-1)),ie={class:"mb-3"},re=n(()=>a("label",{for:"pendidikanPj",class:"form-label"},"Pendidikan",-1)),de={class:"mb-3"},ce=n(()=>a("label",{for:"nikPj",class:"form-label"},"NIK",-1)),ue={class:"mb-3"},pe=n(()=>a("label",{for:"wargaNegaraPj",class:"form-label"},"Warga Negara",-1)),me={class:"mb-3"},he=n(()=>a("label",{for:"koordinat",class:"form-label"},"Koordinat",-1)),be={class:"container-fluid"},ke=n(()=>a("button",{type:"button",class:"btn btn-secondary","data-dismiss":"modal"}," Batal ",-1));U.use(Z);const fe={created(){const l=sessionStorage.getItem("token");if(this.myToken=l,l)try{const[i,c]=l.split("."),y=JSON.parse(atob(i)),_=atob(c),s=JSON.parse(atob(l.split(".")[1])),P=s.exp,p=new Date(P*1e3);console.log("Waktu Kedaluwarsa (UTC):",p.toUTCString()),new Date>p?(console.log("Keluar"),sessionStorage.removeItem("token"),this.$router.push("/")):console.log("Aman");const v=s.level;this.user_id=s.id,console.log("ini idddd:",this.user_id),v!=="1"?this.$router.push("/unauthorized"):(!y||!_)&&this.$router.push("/")}catch(i){console.error("Error decoding token:",i),this.$router.push("/")}else this.$router.push("/")},methods:{goToDetail(l,i){i=="hotel"?this.$router.push({name:"admin-detail-hotel",params:{id:l}}):i=="hiburan"?this.$router.push({name:"admin-detail-hiburan",params:{id:l}}):i=="fnb"&&this.$router.push({name:"admin-detail-fnb",params:{id:l}})}}},_e=Object.assign(fe,{__name:"RekapitulasiAllView",setup(l){const i=h(!1),c=h(""),y=()=>{i.value=!i.value,c.value=i.value?"toggled":""},_=h([]),s=h({type:"",nib:"",nama:"",resiko:"",skalaUsaha:"",alamat:"",koordinat:"",namaPj:"",emailPj:"",passwordPj:"",nikPj:"",pendidikanPj:"",teleponPj:"",wargaNegaraPj:"",bintangHotel:"",kamarVip:"",kamarStandart:""}),P=h("");h(!1);const p=h(!1),v=async()=>{p.value=!1;try{const t=(await k.get("https://api.surveiwisatadki.com/api/list-all",{headers:{Authorization:"Bearer "+sessionStorage.getItem("token")}})).data.data;_.value=[...t.hotel.map(e=>({...e,type:"hotel"})),...t.hiburan.map(e=>({...e,type:"hiburan"})),...t.fnb.map(e=>({...e,type:"fnb"}))],p.value=!0}catch(o){p.value=!0,console.error(o)}},D=R(()=>P.value?_.value.filter(o=>o.type===P.value):_.value),B=async o=>{try{return(await k.get(`https://api.surveiwisatadki.com/api/hotel/detail-hotel/${o}`,{headers:{Authorization:"Bearer "+sessionStorage.getItem("token")}})).data.data.hotel}catch(t){readyHotel.value=!0,console.error(t)}},L=async o=>{try{return(await k.get(`https://api.surveiwisatadki.com/api/hiburan/detail-hiburan/${o}`,{headers:{Authorization:"Bearer "+sessionStorage.getItem("token")}})).data.data.hiburan}catch(t){readyHiburan.value=!0,console.error(t)}},H=async o=>{try{return(await k.get(`https://api.surveiwisatadki.com/api/fnb/detail-fnb/${o}`,{headers:{Authorization:"Bearer "+sessionStorage.getItem("token")}})).data.data.fnb}catch(t){readyFnb.value=!0,console.error(t)}},T=async o=>{s.value={...o,nama:o.namaHotel||o.namaHiburan||o.namaFnb,bintangHotel:o.bintangHotel||"",kamarVip:o.kamarVip||"",kamarStandart:o.kamarStandart||""};let t;o.type==="hotel"?t=await B(o.id):o.type==="hiburan"?t=await L(o.id):o.type==="fnb"&&(t=await H(o.id)),t&&(s.value={...s.value,...t})},N=async()=>{try{const{type:o,id:t,...e}=s.value;let u={};o==="hotel"?u={namaHotel:e.nama,bintangHotel:e.bintangHotel,kamarVip:e.kamarVip,kamarStandart:e.kamarStandart}:o==="hiburan"?u={namaHiburan:e.nama}:o==="fnb"&&(u={namaFnb:e.nama}),await k.post(`https://api.surveiwisatadki.com/api/${o}/update-${o}/${t}`,{...e,...u},{headers:{Authorization:"Bearer "+sessionStorage.getItem("token")}}),await v(),j("Request Success","Data berhasil di update","success")}catch(o){j("Request Failed","Data gagal di update","error"),console.error(o)}},I=async(o,t)=>{try{await k.delete(`https://api.surveiwisatadki.com/api/${o}/delete-${o}/${t}`,{headers:{Authorization:"Bearer "+sessionStorage.getItem("token")}}),await v(),j("Request Success","Data berhasil dihapus","success")}catch(e){j("Request Failed","Data gagal dihapus","error"),console.error(e)}},A=o=>{console.log("Location selected:",o),s.value.koordinat=o},E=(o,t,e)=>{V.fire({title:"Konfirmasi Penghapusan",text:`Apakah Anda yakin ingin menghapus ${o} ${e}?`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#061387",confirmButtonText:"Hapus",cancelButtonText:"Batal"}).then(u=>{u.isConfirmed&&I(o,t)})},j=(o,t,e)=>{V.fire({title:o,text:t,icon:e}).then(()=>{$("#updateModal").modal("hide")})},F=async()=>{try{const o=await k.get("https://api.surveiwisatadki.com/api/export",{headers:{Authorization:"Bearer "+sessionStorage.getItem("token")},responseType:"blob"}),t=new Blob([o.data],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),e=document.createElement("a");e.href=window.URL.createObjectURL(t),e.download="data_wisata_export.xlsx",document.body.appendChild(e),e.click(),document.body.removeChild(e)}catch(o){console.error(o)}};return v(),(o,t)=>(f(),g(x,null,[a("div",sa,[S(Q,{class:z(c.value)},null,8,["class"]),a("div",la,[a("div",na,[S(X,{onToggleSidebar:y}),a("div",ia,[ra,da,a("div",ca,[a("div",ua,[a("div",{class:"row"},[pa,a("div",{class:"col-sm-6 d-flex justify-content-end mt-3"},[a("button",{type:"button",class:"btn btn-success ml-2 my-auto",style:{"border-radius":"8px"},onClick:F}," Export ")])]),a("div",ma,[p.value?C("",!0):(f(),g("div",ha,ka)),p.value?(f(),K(J(U),{key:1,class:"display table table-striped"},{default:q(()=>[fa,a("tbody",null,[(f(!0),g(x,null,O(D.value,(e,u)=>(f(),g("tr",{key:u},[a("th",_a,b(u+1),1),a("td",null,[a("button",{class:"btn btn-warning me-1",type:"button","data-toggle":"modal","data-target":"#updateModal",onClick:m=>T(e)},wa,8,ga),a("button",{class:"btn btn-danger",onClick:m=>E(e.type,e.id,e.nama)},Pa,8,ya)]),a("td",{onClick:m=>o.goToDetail(e.id,e.type)},b(e.nib),9,ja),a("td",{onClick:m=>o.goToDetail(e.id,e.type)},b(e.namaHotel||e.namaHiburan||e.namaFnb),9,Sa),a("td",{onClick:m=>o.goToDetail(e.id,e.type)},b(e.alamat),9,Ca),a("td",{onClick:m=>o.goToDetail(e.id,e.type)},b(e.type==="hiburan"?"Hiburan":e.type==="hotel"?"Hotel":"Makanan & Minuman"),9,xa),a("td",{onClick:m=>o.goToDetail(e.id,e.type)},b(e.namaPj),9,Va),a("td",{onClick:m=>o.goToDetail(e.id,e.type)},b(e.teleponPj),9,Ma)]))),128))])]),_:1})):C("",!0)])])])])]),S(Y)])]),a("div",Ua,[a("div",Da,[a("div",Ba,[La,a("div",Ha,[a("form",null,[a("div",Ta,[Na,r(a("input",{type:"text",class:"form-control",id:"nib",placeholder:"Masukkan NIB","onUpdate:modelValue":t[0]||(t[0]=e=>s.value.nib=e)},null,512),[[d,s.value.nib]])]),a("div",Ia,[Aa,r(a("input",{type:"text",class:"form-control",id:"nama",placeholder:"Masukkan nama","onUpdate:modelValue":t[1]||(t[1]=e=>s.value.nama=e)},null,512),[[d,s.value.nama]])]),a("div",Ea,[Fa,r(a("input",{type:"text",class:"form-control",id:"resiko",placeholder:"Masukkan Resiko","onUpdate:modelValue":t[2]||(t[2]=e=>s.value.resiko=e)},null,512),[[d,s.value.resiko]])]),a("div",Ra,[za,r(a("input",{type:"text",class:"form-control",id:"skalaUsaha",placeholder:"Masukkan Skala Usaha","onUpdate:modelValue":t[3]||(t[3]=e=>s.value.skalaUsaha=e)},null,512),[[d,s.value.skalaUsaha]])]),a("div",Ka,[qa,r(a("input",{type:"text",class:"form-control",id:"alamat",placeholder:"Masukkan alamat","onUpdate:modelValue":t[4]||(t[4]=e=>s.value.alamat=e)},null,512),[[d,s.value.alamat]])]),s.value.type==="hotel"?(f(),g("div",Ja,[a("div",Oa,[Wa,r(a("input",{type:"text",class:"form-control",id:"bintangHotel",placeholder:"Masukkan jumlah kamar","onUpdate:modelValue":t[5]||(t[5]=e=>s.value.bintangHotel=e)},null,512),[[d,s.value.bintangHotel]])]),a("div",Ga,[Qa,r(a("input",{type:"text",class:"form-control",id:"kamarVip",placeholder:"Masukkan jumlah kamar vip","onUpdate:modelValue":t[6]||(t[6]=e=>s.value.kamarVip=e)},null,512),[[d,s.value.kamarVip]])]),a("div",Xa,[Ya,r(a("input",{type:"text",class:"form-control",id:"kamarStandart",placeholder:"Masukkan jumlah kamar standard","onUpdate:modelValue":t[7]||(t[7]=e=>s.value.kamarStandart=e)},null,512),[[d,s.value.kamarStandart]])])])):C("",!0),a("div",Za,[ae,r(a("input",{type:"text",class:"form-control",id:"namaPj",placeholder:"Masukkan nama penanggung jawab","onUpdate:modelValue":t[8]||(t[8]=e=>s.value.namaPj=e)},null,512),[[d,s.value.namaPj]])]),a("div",ee,[te,r(a("input",{type:"email",class:"form-control",id:"emailPj",placeholder:"Masukkan email penanggung jawab","onUpdate:modelValue":t[9]||(t[9]=e=>s.value.emailPj=e)},null,512),[[d,s.value.emailPj]])]),a("div",oe,[se,r(a("input",{type:"password",class:"form-control",id:"passwordPj",placeholder:"Masukkan password penanggung jawab","onUpdate:modelValue":t[10]||(t[10]=e=>s.value.passwordPj=e)},null,512),[[d,s.value.passwordPj]])]),a("div",le,[ne,r(a("input",{type:"text",class:"form-control",id:"teleponPj",placeholder:"Masukkan nomor telepon","onUpdate:modelValue":t[11]||(t[11]=e=>s.value.teleponPj=e)},null,512),[[d,s.value.teleponPj]])]),a("div",ie,[re,r(a("input",{type:"text",class:"form-control",id:"pendidikanPj",placeholder:"Masukkan pendidikan","onUpdate:modelValue":t[12]||(t[12]=e=>s.value.pendidikanPj=e)},null,512),[[d,s.value.pendidikanPj]])]),a("div",de,[ce,r(a("input",{type:"text",class:"form-control",id:"nikPj",placeholder:"Masukkan NIK","onUpdate:modelValue":t[13]||(t[13]=e=>s.value.nikPj=e)},null,512),[[d,s.value.nikPj]])]),a("div",ue,[pe,r(a("input",{type:"text",class:"form-control",id:"wargaNegaraPj",placeholder:"Masukkan warga negara","onUpdate:modelValue":t[14]||(t[14]=e=>s.value.wargaNegaraPj=e)},null,512),[[d,s.value.wargaNegaraPj]])]),a("div",me,[he,r(a("input",{type:"text",class:"form-control",id:"koordinat",placeholder:"Masukkan koordinat","onUpdate:modelValue":t[15]||(t[15]=e=>s.value.koordinat=e),disabled:""},null,512),[[d,s.value.koordinat]])]),a("div",be,[S(oa,{onLocationSelected:A,defaultCoordinate:s.value.koordinat},null,8,["defaultCoordinate"])])])]),a("div",{class:"modal-footer"},[ke,a("button",{type:"button",class:"btn btn-primary",onClick:N}," Simpan Perubahan ")])])])])],64))}}),Ce=M(_e,[["__scopeId","data-v-308fe23b"]]);export{Ce as default};
