import{r as m,b as d,c,d as a,m as p,n as k,f as u,k as w,C as U,D,p as g,v as b,F as f,h as C,e as B,t as _}from"./index-45f3a127.js";import{S as T,N as S,F as A}from"./Footer-21fbf2ec.js";import{a as h,S as F}from"./sweetalert2.all-dde62a0f.js";import{P as y,D as O}from"./jquery.dataTables-ed51dfb9.js";const P={id:"wrapper"},L={id:"content-wrapper",class:"d-flex flex-column"},N={id:"content"},j={class:"container-fluid my-4"},M={class:"row m-1"},I={class:"card p-3",style:{"border-radius":"25px"}},V=C('<div class="row mb-3"><div class="col-6"><div class="h5 font-weight-bold text-black"> Media Partner </div></div><div class="d-flex justify-content-end col-6"><button class="btn btn-primary me-2" data-toggle="modal" data-target="#addData"><i class="bi bi-plus"></i> Tambah </button></div><div class="col-8"></div></div>',1),E={class:"table-responsive"},x={key:0,class:"preloader"},z=a("thead",null,[a("tr",null,[a("th",{scope:"col",style:{width:"50px"}},"No"),a("th",{scope:"col"},"Aksi"),a("th",{scope:"col"},"Nama Media Partner"),a("th",{scope:"col"},"Logo")])],-1),q=["onClick"],K=a("i",{class:"bi bi-pencil-square"},null,-1),H=[K],J=["onClick"],W=a("i",{class:"bi bi-trash3-fill"},null,-1),G=[W],Q=["src"],R={class:"modal fade",id:"addData",tabindex:"-1",role:"dialog","aria-labelledby":"addDataLabel","aria-hidden":"true"},X={class:"modal-dialog",role:"document"},Y={class:"modal-content"},Z=a("div",{class:"modal-header"},[a("h5",{class:"modal-title",id:"addDataLabel"},"Tambah Data"),a("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close"},[a("span",{"aria-hidden":"true"},"×")])],-1),aa={class:"modal-body"},ta={class:"form-group"},ea=a("label",{for:"nama"},"Nama Media Partner",-1),oa={class:"form-group"},sa=a("label",{for:"logo"},"Logo",-1),ra={class:"modal-footer"},na=a("button",{type:"button",class:"btn btn-secondary","data-dismiss":"modal"}," Batal ",-1),la={class:"modal fade",id:"dataUpdate",tabindex:"-1",role:"dialog","aria-labelledby":"dataUpdateLabel","aria-hidden":"true"},da={class:"modal-dialog",role:"document"},ia={class:"modal-content"},ca=a("div",{class:"modal-header"},[a("h5",{class:"modal-title",id:"dataUpdateLabel"},"Update Data"),a("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close"},[a("span",{"aria-hidden":"true"},"×")])],-1),ha={class:"modal-body"},pa={class:"form-group"},ma=a("label",{for:"nama"},"Nama Media Partner",-1),ua={class:"form-group"},ga=a("label",{for:"logo"},"Logo",-1),ba={class:"modal-footer"},fa=a("button",{type:"button",class:"btn btn-secondary","data-dismiss":"modal"}," Batal ",-1);y.use(O);const _a={data(){return{dataList:[],tableOptions:{pagingType:"full_numbers"},dataCreate:{nama:"",logo:null},dataUpdate:{id:"",nama:"",logo:null},ready:!1}},mounted(){},methods:{setDataUpdate(t,e,r){this.dataUpdate.id=t,this.dataUpdate.nama=e,this.dataUpdate.logo=r},async sendUpdateData(){try{const t=new FormData;t.append("nama",this.dataUpdate.nama),this.dataUpdate.logo instanceof File&&t.append("logo",this.dataUpdate.logo);const e=await h.post(`http://127.0.0.1:8000/api/media-partner/update/${this.dataUpdate.id}`,t,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${sessionStorage.getItem("token")}`}});console.log(e.data),this.dataUpdate={id:"",nama:"",logo:null},this.$refs.logo.value="",this.fetchData(),this.showAlert("Berhasil!","Data berhasil diupdate.","success")}catch(t){if(console.error(t),t.response&&t.response.data&&t.response.data.errors){const e=t.response.data.errors;let r=`Terjadi kesalahan:
`;for(let l in e)e.hasOwnProperty(l)&&(r+=`${e[l].join(", ")}
`);this.showError("Opps...",r,"error")}else this.showError("Opps...","Terjadi kesalahan saat menambahkan data.","error")}},async tambahData(){try{const t=new FormData;t.append("nama",this.dataCreate.nama),t.append("logo",this.dataCreate.logo);const e=await h.post("http://127.0.0.1:8000/api/media-partner/create",t,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${sessionStorage.getItem("token")}`}});console.log(e.data),this.dataCreate={nama:"",logo:null},this.$refs.logo.value="",this.fetchData(),this.showAlert("Berhasil!","Data berhasil ditambahkan.","success")}catch(t){if(console.error(t),t.response&&t.response.data&&t.response.data.errors){const e=t.response.data.errors;let r=`Terjadi kesalahan:
`;for(let l in e)e.hasOwnProperty(l)&&(r+=`${e[l].join(", ")}
`);this.showError("Opps...",r,"error")}else this.showError("Opps...","Terjadi kesalahan saat menambahkan data.","error")}},async fetchData(){this.ready=!1;try{const t=await h.get("http://127.0.0.1:8000/api/media-partner/list",{headers:{Authorization:`Bearer ${sessionStorage.getItem("token")}`}});this.dataList=t.data.data,this.ready=!0}catch(t){console.error(t),this.showAlert("Opps...","Terjadi kesalahan saat mengambil data.","error")}},showAlert(t,e,r){this.$swal({title:t,text:e,icon:r}).then(()=>{$("#addData").modal("hide"),$("#dataUpdate").modal("hide")})},showError(t,e,r){this.$swal({title:t,text:e,icon:r}).then(()=>{})},async deleteData(t){try{const e=await h.delete(`http://127.0.0.1:8000/api/media-partner/delete/${t}`,{headers:{Authorization:`Bearer ${sessionStorage.getItem("token")}`}});console.log(e.data),this.fetchData(),this.showAlert("Success","Data berhasil didelete","success")}catch(e){console.error(e),this.showAlert("Oops...","Terjadi kesalahan saat mendelete data","error")}},konfirmasi(t,e){F.fire({title:`Apakah Anda yakin ingin menghapus data ${e}?`,text:"Data akan dihapus jika anda menekan tombol Hapus.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#ee0405",cancelButtonColor:"#858796",confirmButtonText:"Hapus",cancelButtonText:"Batal"}).then(r=>{r.isConfirmed&&this.deleteData(t)})},handleCreateFileUpload(t){this.dataCreate.logo=t.target.files[0]},handleUpdateFileUpload(t){this.dataUpdate.logo=t.target.files[0]},getImageUrl(t){return t!=null?`http://127.0.0.1:8000/storage/${t}`:"https://via.placeholder.com/150"}},created(){const t=sessionStorage.getItem("token");if(t)try{const[e,r]=t.split("."),l=JSON.parse(atob(e)),s=atob(r),o=JSON.parse(atob(t.split(".")[1])).exp,i=new Date(o*1e3);console.log("Waktu Kedaluwarsa (UTC):",i.toUTCString()),new Date>i?(console.log("Keluar"),sessionStorage.removeItem("token"),this.$router.push("/login")):console.log("Aman"),this.fetchData()}catch(e){console.error("Error decoding token:",e),this.$router.push("/login")}else this.$router.push("/login")}},Ua=Object.assign(_a,{__name:"MediaPartnerView",setup(t){const e=m(!1),r=m(""),l=()=>{e.value=!e.value,r.value=e.value?"toggled":""};return(s,n)=>(d(),c(f,null,[a("div",P,[p(T,{class:k(r.value)},null,8,["class"]),a("div",L,[a("div",N,[p(S,{onToggleSidebar:l}),a("div",j,[a("div",M,[a("div",I,[V,a("div",E,[s.ready?u("",!0):(d(),c("div",x)),s.ready?(d(),w(D(y),{key:1,class:"display table table-striped",options:s.tableOptions},{default:U(()=>[z,a("tbody",null,[(d(!0),c(f,null,B(s.dataList,(o,i)=>(d(),c("tr",{key:o.id},[a("td",null,_(i+1),1),a("td",null,[a("button",{class:"btn btn-warning me-1 mb-1","data-toggle":"modal","data-target":"#dataUpdate",onClick:v=>s.setDataUpdate(o.id,o.nama,o.logo)},H,8,q),a("button",{class:"btn btn-danger me-1 mb-1",onClick:v=>s.konfirmasi(o.id,o.nama)},G,8,J)]),a("td",null,_(o.nama),1),a("td",null,[a("img",{src:s.getImageUrl(o.logo),alt:"Logo Media Partner",class:"img-fluid",style:{width:"150px"}},null,8,Q)])]))),128))])]),_:1},8,["options"])):u("",!0)])])])])]),p(A)])]),a("div",R,[a("div",X,[a("div",Y,[Z,a("div",aa,[a("form",null,[a("div",ta,[ea,g(a("input",{type:"text",class:"form-control",id:"nama","onUpdate:modelValue":n[0]||(n[0]=o=>s.dataCreate.nama=o),placeholder:"Masukkan nama media Partner",required:""},null,512),[[b,s.dataCreate.nama]])]),a("div",oa,[sa,a("input",{type:"file",class:"form-control",id:"logo",onChange:n[1]||(n[1]=(...o)=>s.handleCreateFileUpload&&s.handleCreateFileUpload(...o)),ref:"logo"},null,544)])])]),a("div",ra,[na,a("button",{type:"button",class:"btn btn-primary",onClick:n[2]||(n[2]=(...o)=>s.tambahData&&s.tambahData(...o))}," Kirim ")])])])]),a("div",la,[a("div",da,[a("div",ia,[ca,a("div",ha,[a("form",null,[a("div",pa,[ma,g(a("input",{type:"text",class:"form-control",id:"nama","onUpdate:modelValue":n[3]||(n[3]=o=>s.dataUpdate.nama=o),required:""},null,512),[[b,s.dataUpdate.nama]])]),a("div",ua,[ga,a("input",{type:"file",class:"form-control",id:"logo",onChange:n[4]||(n[4]=(...o)=>s.handleUpdateFileUpload&&s.handleUpdateFileUpload(...o)),ref:"logo"},null,544)])])]),a("div",ba,[fa,a("button",{type:"button",class:"btn btn-danger",onClick:n[5]||(n[5]=(...o)=>s.sendUpdateData&&s.sendUpdateData(...o))}," Update ")])])])])],64))}});export{Ua as default};
