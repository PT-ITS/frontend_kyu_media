import{_ as U,r as c,b as p,f as k,g as a,i as y,n as I,c as z,A as F,B as q,s as x,t as m,j as h,v as _,F as S,z as E,x as R,y as j}from"./index-ff3a5314.js";import{S as J}from"./Sidebar-f27aa015.js";import{N as K,F as L}from"./Footer-a99f178f.js";import{a as P}from"./axios-a342f982.js";import{S as B}from"./sweetalert2.all-ba5903e9.js";import{P as C,D as M}from"./jquery.dataTables-5bb2cc9b.js";const l=i=>(R("data-v-e64677d2"),i=i(),j(),i),O={id:"wrapper"},W={id:"content-wrapper",class:"d-flex flex-column"},G={id:"content"},Q={class:"container-fluid mt-4"},X=l(()=>a("h1",{class:"mb-0 fw-bold customJudul"},"Validator",-1)),Y=l(()=>a("p",null,"Semangat semoga harimu menyenangkan",-1)),Z={class:"customBox mt-3"},aa={class:"container-fluid"},ea=l(()=>a("div",{class:"col-sm-6 mb-3"},[a("h6",{class:"fw-bold pt-3",style:{"font-size":"20px"}}," Data Pengguna ")],-1)),ta={class:"table-responsive"},sa=l(()=>a("thead",null,[a("tr",null,[a("th",{scope:"col"},"No"),a("th",{scope:"col"},"Aksi"),a("th",{scope:"col"},"Nama"),a("th",{scope:"col"},"Email"),a("th",{scope:"col"},"Alamat"),a("th",{scope:"col"},"Nomor Telepon")])],-1)),oa={scope:"row"},la=["onClick"],na=l(()=>a("i",{class:"bi bi-pencil-square"},null,-1)),ia=[na],da=["onClick"],ra=l(()=>a("i",{class:"bi bi-trash"},null,-1)),ua=[ra],ca={class:"modal fade",id:"updatePengguna",tabindex:"-1",role:"dialog","aria-labelledby":"updatePenggunaLabel","aria-hidden":"true"},ma={class:"modal-dialog",role:"document"},pa={class:"modal-content"},ha={class:"modal-header"},_a={class:"modal-title",id:"updatePenggunaLabel"},ga=l(()=>a("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close"},[a("span",{"aria-hidden":"true"},"Ã—")],-1)),va={class:"modal-body"},ba={class:"mb-3"},fa=l(()=>a("label",{for:"name",class:"form-label"},"Nama Pengguna",-1)),ka={class:"mb-3"},wa=l(()=>a("label",{for:"email",class:"form-label"},"Email",-1)),ya={key:0,class:"mb-3"},Pa=l(()=>a("label",{for:"password",class:"form-label"},"Password",-1)),xa={class:"mb-3"},Sa=l(()=>a("label",{for:"alamat",class:"form-label"},"Alamat",-1)),Ba={class:"mb-3"},Ca=l(()=>a("label",{for:"noHP",class:"form-label"},"Nomor Telepon",-1)),$a=l(()=>a("button",{type:"button",class:"btn btn-secondary","data-dismiss":"modal"}," Batal ",-1)),Da={created(){const i=sessionStorage.getItem("token");if(this.myToken=i,i)try{const[r,g]=i.split("."),v=JSON.parse(atob(r)),e=atob(g),n=JSON.parse(atob(i.split(".")[1])),d=n.exp,u=new Date(d*1e3);console.log("Waktu Kedaluwarsa (UTC):",u.toUTCString()),new Date>u?(console.log("Keluar"),sessionStorage.removeItem("token"),this.$router.push("/")):console.log("Aman");const w=n.level;this.user_id=n.id,console.log("ini idddd:",this.user_id),w!=="1"?this.$router.push("/unauthorized"):(!v||!e)&&this.$router.push("/")}catch(r){console.error("Error decoding token:",r),this.$router.push("/")}else this.$router.push("/")}},Ta=Object.assign(Da,{__name:"PenggunaView",setup(i){C.use(M);const r=c(!1),g=c(""),v=c([]),e=c({id:"",name:"",email:"",alamat:"",noHP:"",password:""}),n=c(!1),d=c(!1),u=async()=>{try{const t=await P.get("https://api.surveiwisatadki.com/api/auth/list-pengguna",{headers:{Authorization:"Bearer "+sessionStorage.getItem("token")}});v.value=t.data.data,d.value=!0}catch(t){d.value=!0,console.error(t)}},w=t=>{e.value.id=t.id,e.value.name=t.name,e.value.email=t.email,e.value.alamat=t.alamat,e.value.noHP=t.noHP,e.value.password="",n.value=!0},D=()=>{e.value.id="",e.value.name="",e.value.email="",e.value.alamat="",e.value.noHP="",e.value.password="",n.value=!1},T=async()=>{try{const t=new FormData;t.append("name",e.value.name),t.append("email",e.value.email),t.append("alamat",e.value.alamat),t.append("noHP",e.value.noHP),n.value||t.append("password",e.value.password);const o=n.value?`https://api.surveiwisatadki.com/api/auth/update/${e.value.id}`:"https://api.surveiwisatadki.com/api/auth/register",s=await P.post(o,t,{headers:{Authorization:"Bearer "+sessionStorage.getItem("token")}});u();const f=n.value?"diperbarui":"ditambahkan";b("Request Success",`Pengguna berhasil ${f}`,"success")}catch(t){const o=n.value?"diperbarui":"ditambahkan";b("Request Failed",`Pengguna gagal ${o}`,"error"),d.value=!0,console.error(t)}},H=(t,o)=>{B.fire({title:"Konfirmasi Penghapusan",text:`Apakah Anda yakin ingin menghapus pengguna ${o}?`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#061387",confirmButtonText:"Hapus",cancelButtonText:"Batal"}).then(s=>{s.isConfirmed&&A(t)})},A=async t=>{d.value=!1;try{await P.delete(`https://api.surveiwisatadki.com/api/auth/delete/${t}`,{headers:{Authorization:"Bearer "+sessionStorage.getItem("token")}}),b("Request Success","Pengguna berhasil dihapus","success"),u()}catch(o){b("Request Failed","Pengguna gagal dihapus","error"),console.error(o),d.value=!0}},b=(t,o,s)=>{B.fire({title:t,text:o,icon:s}).then(()=>{$("#updatePengguna").modal("hide")})},N=()=>{r.value=!r.value,g.value=r.value?"toggled":""};return u(),(t,o)=>(p(),k(S,null,[a("div",O,[y(J,{class:I(g.value)},null,8,["class"]),a("div",W,[a("div",G,[y(K,{onToggleSidebar:N}),a("div",Q,[X,Y,a("div",Z,[a("div",aa,[a("div",{class:"row"},[ea,a("div",{class:"col-sm-6 d-flex justify-content-end my-3"},[a("button",{type:"button",class:"btn btn-success ml-2","data-toggle":"modal","data-target":"#updatePengguna",onClick:D,style:{"background-color":"#327371","border-radius":"20px"}}," Tambah ")])]),a("div",ta,[d.value?(p(),z(q(C),{key:0,class:"display table table-striped"},{default:F(()=>[sa,a("tbody",null,[(p(!0),k(S,null,E(v.value,(s,f)=>(p(),k("tr",{key:f},[a("th",oa,m(f+1),1),a("td",null,[a("button",{class:"btn btn-warning me-1",type:"button","data-toggle":"modal","data-target":"#updatePengguna",onClick:V=>w(s)},ia,8,la),a("button",{class:"btn btn-danger",onClick:V=>H(s.id,s.name)},ua,8,da)]),a("td",null,m(s.name),1),a("td",null,m(s.email),1),a("td",null,m(s.alamat),1),a("td",null,m(s.noHP),1)]))),128))])]),_:1})):x("",!0)])])])])]),y(L)])]),a("div",ca,[a("div",ma,[a("div",pa,[a("div",ha,[a("h5",_a,m(n.value?"Update Data Pengguna":"Tambah Data Pengguna"),1),ga]),a("div",va,[a("form",null,[a("div",ba,[fa,h(a("input",{type:"text",class:"form-control",id:"name",placeholder:"masukkan nama pengguna","onUpdate:modelValue":o[0]||(o[0]=s=>e.value.name=s)},null,512),[[_,e.value.name]])]),a("div",ka,[wa,h(a("input",{type:"email",class:"form-control",id:"email",placeholder:"masukkan email pengguna","onUpdate:modelValue":o[1]||(o[1]=s=>e.value.email=s)},null,512),[[_,e.value.email]])]),n.value?x("",!0):(p(),k("div",ya,[Pa,h(a("input",{type:"password",class:"form-control",id:"password",placeholder:"masukkan password","onUpdate:modelValue":o[2]||(o[2]=s=>e.value.password=s)},null,512),[[_,e.value.password]])])),a("div",xa,[Sa,h(a("input",{type:"text",class:"form-control",id:"alamat",placeholder:"masukkan alamat pengguna","onUpdate:modelValue":o[3]||(o[3]=s=>e.value.alamat=s)},null,512),[[_,e.value.alamat]])]),a("div",Ba,[Ca,h(a("input",{type:"text",class:"form-control",id:"noHP",placeholder:"masukkan nomor telepon","onUpdate:modelValue":o[4]||(o[4]=s=>e.value.noHP=s)},null,512),[[_,e.value.noHP]])]),a("div",{class:"modal-footer"},[$a,a("button",{type:"button",class:"btn blueButton",onClick:T}," Simpan ")])])])])])])],64))}}),za=U(Ta,[["__scopeId","data-v-e64677d2"]]);export{za as default};
