import{_ as M,L as v,b,f,r as _,H as A,g as a,i as j,n as E,s as x,c as R,A as F,B as z,j as d,v as r,F as S,z as K,t as h,x as q,y as J}from"./index-ff3a5314.js";import{S as O}from"./Sidebar-a2ee7b5f.js";import{N as W,F as G}from"./Footer-a99f178f.js";import{S as V}from"./sweetalert2.all-ba5903e9.js";import{a as C}from"./axios-a342f982.js";import"./xlsx-6464457c.js";import"./leaflet.curve-0e7c6766.js";import{P as U,D as Q}from"./jquery.dataTables-5bb2cc9b.js";const X={name:"LeafletMap",props:{defaultCoordinate:{type:String,required:!1,default:""}},data(){return{map:null,marker:null}},mounted(){if(this.map=v.map("mapContainerEdit"),v.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}).addTo(this.map),this.defaultCoordinate){const[l,i]=this.defaultCoordinate.split(",");this.map.setView([l,i],12),this.marker=v.marker([l,i]).addTo(this.map)}else navigator.geolocation?navigator.geolocation.getCurrentPosition(l=>{const i=l.coords.latitude,c=l.coords.longitude;this.map.setView([i,c],12),this.marker=v.marker([i,c]).addTo(this.map),this.$emit("location-selected",`${i},${c}`)},()=>{this.map.setView([-6.2088,106.8456],12),this.$emit("location-selected",`${-6.2088},${106.8456}`)}):(this.map.setView([-6.2088,106.8456],12),this.$emit("location-selected",`${-6.2088},${106.8456}`));this.map.on("click",this.onMapClick)},methods:{onMapClick(l){this.$emit("location-selected",`${l.latlng.lat},${l.latlng.lng}`),this.marker&&this.map.removeLayer(this.marker),this.marker=v.marker(l.latlng).addTo(this.map)}},beforeUnmount(){this.map&&this.map.remove()}},Y={id:"mapContainerEdit"};function Z(l,i,c,w,k,o){return b(),f("div",Y)}const aa=M(X,[["render",Z],["__scopeId","data-v-e59bc24b"]]);const n=l=>(q("data-v-425c25c9"),l=l(),J(),l),ea={id:"wrapper"},ta={id:"content-wrapper",class:"d-flex flex-column"},oa={id:"content"},sa={class:"container-fluid mt-4"},la=n(()=>a("h1",{class:"mb-0 fw-bold customJudul"},"Rekapitulasi",-1)),na=n(()=>a("p",null,"Semangat semoga harimu menyenangkan",-1)),ia={class:"customBox mt-3"},da={class:"container-fluid"},ra=n(()=>a("div",{class:"col-sm-6 mb-3"},[a("h6",{class:"fw-bold pt-3",style:{"font-size":"20px"}}," Rekapitulasi Data ")],-1)),ca={class:"table-responsive"},ua={key:0,class:"loading-container"},pa=n(()=>a("span",{class:"loading-text"},"Loading ...",-1)),ma=[pa],ha=n(()=>a("thead",null,[a("tr",null,[a("th",{scope:"col"},"No"),a("th",{scope:"col"},"Aksi"),a("th",{scope:"col"},"NIB"),a("th",{scope:"col"},"Nama"),a("th",{scope:"col"},"Alamat"),a("th",{scope:"col"},"Jenis"),a("th",{scope:"col"},"Penanggung Jawab"),a("th",{scope:"col"},"Nomor Telepon")])],-1)),ba={scope:"row"},ka=["onClick"],_a=n(()=>a("i",{class:"bi bi-pencil-square"},null,-1)),fa=[_a],ga=["onClick"],va=n(()=>a("i",{class:"bi bi-trash"},null,-1)),wa=[va],ya=["onClick"],Pa=["onClick"],ja=["onClick"],$a=["onClick"],Ca=["onClick"],xa=["onClick"],Sa={class:"modal fade",id:"updateModal",tabindex:"-1",role:"dialog","aria-labelledby":"updateModalLabel","aria-hidden":"true"},Va={class:"modal-dialog",role:"document"},Ma={class:"modal-content"},Ua=n(()=>a("div",{class:"modal-header"},[a("h5",{class:"modal-title",id:"updateModalLabel"},"Update Data"),a("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close"},[a("span",{"aria-hidden":"true"},"Ã—")])],-1)),La={class:"modal-body"},Da={class:"mb-3"},Ta=n(()=>a("label",{for:"nib",class:"form-label"},"NIB",-1)),Ba={class:"mb-3"},Na=n(()=>a("label",{for:"nama",class:"form-label"},"Nama",-1)),Ha={class:"mb-3"},Ia=n(()=>a("label",{for:"resiko",class:"form-label"},"Resiko",-1)),Aa={class:"mb-3"},Ea=n(()=>a("label",{for:"skalaUsaha",class:"form-label"},"Skala Usaha",-1)),Ra={class:"mb-3"},Fa=n(()=>a("label",{for:"alamat",class:"form-label"},"Alamat",-1)),za={key:0},Ka={class:"mb-3"},qa=n(()=>a("label",{for:"bintangHotel",class:"form-label"},"Bintang Hotel",-1)),Ja={class:"mb-3"},Oa=n(()=>a("label",{for:"kamarVip",class:"form-label"},"Kamar VIP",-1)),Wa={class:"mb-3"},Ga=n(()=>a("label",{for:"kamarStandart",class:"form-label"},"Kamar Standard",-1)),Qa={class:"mb-3"},Xa=n(()=>a("label",{for:"namaPj",class:"form-label"},"Penanggung Jawab",-1)),Ya={class:"mb-3"},Za=n(()=>a("label",{for:"emailPj",class:"form-label"},"Email",-1)),ae={class:"mb-3"},ee=n(()=>a("label",{for:"passwordPj",class:"form-label"},"Password",-1)),te={class:"mb-3"},oe=n(()=>a("label",{for:"teleponPj",class:"form-label"},"Nomor Telepon",-1)),se={class:"mb-3"},le=n(()=>a("label",{for:"pendidikanPj",class:"form-label"},"Pendidikan",-1)),ne={class:"mb-3"},ie=n(()=>a("label",{for:"nikPj",class:"form-label"},"NIK",-1)),de={class:"mb-3"},re=n(()=>a("label",{for:"wargaNegaraPj",class:"form-label"},"Warga Negara",-1)),ce={class:"mb-3"},ue=n(()=>a("label",{for:"koordinat",class:"form-label"},"Koordinat",-1)),pe={class:"container-fluid"},me=n(()=>a("button",{type:"button",class:"btn btn-secondary","data-dismiss":"modal"}," Batal ",-1));U.use(Q);const he={created(){const l=sessionStorage.getItem("token");if(this.myToken=l,l)try{const[i,c]=l.split("."),w=JSON.parse(atob(i)),k=atob(c),o=JSON.parse(atob(l.split(".")[1])),y=o.exp,p=new Date(y*1e3);console.log("Waktu Kedaluwarsa (UTC):",p.toUTCString()),new Date>p?(console.log("Keluar"),sessionStorage.removeItem("token"),this.$router.push("/")):console.log("Aman");const g=o.level;this.user_id=o.id,console.log("ini idddd:",this.user_id),g!=="2"?this.$router.push("/unauthorized"):(!w||!k)&&this.$router.push("/")}catch(i){console.error("Error decoding token:",i),this.$router.push("/")}else this.$router.push("/")},methods:{goToDetail(l,i){i=="hotel"?this.$router.push({name:"pengelola-detail-hotel",params:{id:l}}):i=="hiburan"?this.$router.push({name:"pengelola-detail-hiburan",params:{id:l}}):i=="fnb"&&this.$router.push({name:"pengelola-detail-fnb",params:{id:l}})}}},be=Object.assign(he,{__name:"RekapitulasiAllView",setup(l){const i=_(!1),c=_(""),w=()=>{i.value=!i.value,c.value=i.value?"toggled":""},k=_([]),o=_({type:"",nib:"",nama:"",resiko:"",skalaUsaha:"",alamat:"",koordinat:"",namaPj:"",emailPj:"",passwordPj:"",nikPj:"",pendidikanPj:"",teleponPj:"",wargaNegaraPj:"",bintangHotel:"",kamarVip:"",kamarStandart:""}),y=_(""),p=_(!1),g=async()=>{p.value=!1;try{const t=(await C.get("https://api.surveiwisatadki.com/api/list-all",{headers:{Authorization:"Bearer "+sessionStorage.getItem("token")}})).data.data;k.value=[...t.hotel.map(e=>({...e,type:"hotel"})),...t.hiburan.map(e=>({...e,type:"hiburan"})),...t.fnb.map(e=>({...e,type:"fnb"}))],p.value=!0}catch(s){console.error(s),p.value=!0}},L=A(()=>y.value?k.value.filter(s=>s.type===y.value):k.value),D=s=>{o.value={...s,nama:s.namaHotel||s.namaHiburan||s.namaFnb,bintangHotel:s.bintangHotel||"",kamarVip:s.kamarVip||"",kamarStandart:s.kamarStandart||""}},T=async()=>{try{const{type:s,id:t,...e}=o.value;let u={};s==="hotel"?u={namaHotel:e.nama,bintangHotel:e.bintangHotel,kamarVip:e.kamarVip,kamarStandart:e.kamarStandart}:s==="hiburan"?u={namaHiburan:e.nama}:s==="fnb"&&(u={namaFnb:e.nama}),await C.post(`https://api.surveiwisatadki.com/api/${s}/update-${s}/${t}`,{...e,...u},{headers:{Authorization:"Bearer "+sessionStorage.getItem("token")}}),await g(),P("Request Success","Data berhasil di update","success")}catch(s){P("Request Failed","Data gagal di update","error"),console.error(s)}},B=async(s,t)=>{try{await C.delete(`https://api.surveiwisatadki.com/api/${s}/delete-${s}/${t}`,{headers:{Authorization:"Bearer "+sessionStorage.getItem("token")}}),await g(),P("Request Success","Data berhasil dihapus","success")}catch(e){P("Request Failed","Data gagal dihapus","error"),console.error(e)}},N=(s,t,e)=>{V.fire({title:"Konfirmasi Penghapusan",text:`Apakah Anda yakin ingin menghapus ${s} ${e}?`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#061387",confirmButtonText:"Hapus",cancelButtonText:"Batal"}).then(u=>{u.isConfirmed&&B(s,t)})},H=s=>{console.log("Location selected:",s),o.value.koordinat=s},P=(s,t,e)=>{V.fire({title:s,text:t,icon:e}).then(()=>{$("#updateModal").modal("hide")})},I=async()=>{try{const s=await C.get("https://api.surveiwisatadki.com/api/export",{headers:{Authorization:"Bearer "+sessionStorage.getItem("token")},responseType:"blob"}),t=new Blob([s.data],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),e=document.createElement("a");e.href=window.URL.createObjectURL(t),e.download="data_wisata_export.xlsx",document.body.appendChild(e),e.click(),document.body.removeChild(e)}catch(s){console.error(s)}};return g(),(s,t)=>(b(),f(S,null,[a("div",ea,[j(O,{class:E(c.value)},null,8,["class"]),a("div",ta,[a("div",oa,[j(W,{onToggleSidebar:w}),a("div",sa,[la,na,a("div",ia,[a("div",da,[a("div",{class:"row"},[ra,a("div",{class:"col-sm-6 d-flex justify-content-end mt-3"},[a("button",{type:"button",class:"btn btn-success ml-2 my-auto",style:{"border-radius":"8px"},onClick:I}," Export ")])]),a("div",ca,[p.value?x("",!0):(b(),f("div",ua,ma)),p.value?(b(),R(z(U),{key:1,class:"display table table-striped"},{default:F(()=>[ha,a("tbody",null,[(b(!0),f(S,null,K(L.value,(e,u)=>(b(),f("tr",{key:u},[a("th",ba,h(u+1),1),a("td",null,[a("button",{class:"btn btn-warning me-1",type:"button","data-toggle":"modal","data-target":"#updateModal",onClick:m=>D(e)},fa,8,ka),a("button",{class:"btn btn-danger",onClick:m=>N(e.type,e.id,e.nama)},wa,8,ga)]),a("td",{onClick:m=>s.goToDetail(e.id,e.type)},h(e.nib),9,ya),a("td",{onClick:m=>s.goToDetail(e.id,e.type)},h(e.namaHotel||e.namaHiburan||e.namaFnb),9,Pa),a("td",{onClick:m=>s.goToDetail(e.id,e.type)},h(e.alamat),9,ja),a("td",{onClick:m=>s.goToDetail(e.id,e.type)},h(e.type==="hiburan"?"Hiburan":e.type==="hotel"?"Hotel":"Makanan & Minuman"),9,$a),a("td",{onClick:m=>s.goToDetail(e.id,e.type)},h(e.namaPj),9,Ca),a("td",{onClick:m=>s.goToDetail(e.id,e.type)},h(e.teleponPj),9,xa)]))),128))])]),_:1})):x("",!0)])])])])]),j(G)])]),a("div",Sa,[a("div",Va,[a("div",Ma,[Ua,a("div",La,[a("form",null,[a("div",Da,[Ta,d(a("input",{type:"text",class:"form-control",id:"nib",placeholder:"Masukkan NIB","onUpdate:modelValue":t[0]||(t[0]=e=>o.value.nib=e)},null,512),[[r,o.value.nib]])]),a("div",Ba,[Na,d(a("input",{type:"text",class:"form-control",id:"nama",placeholder:"Masukkan nama","onUpdate:modelValue":t[1]||(t[1]=e=>o.value.nama=e)},null,512),[[r,o.value.nama]])]),a("div",Ha,[Ia,d(a("input",{type:"text",class:"form-control",id:"resiko",placeholder:"Masukkan Resiko","onUpdate:modelValue":t[2]||(t[2]=e=>o.value.resiko=e)},null,512),[[r,o.value.resiko]])]),a("div",Aa,[Ea,d(a("input",{type:"text",class:"form-control",id:"skalaUsaha",placeholder:"Masukkan Skala Usaha","onUpdate:modelValue":t[3]||(t[3]=e=>o.value.skalaUsaha=e)},null,512),[[r,o.value.skalaUsaha]])]),a("div",Ra,[Fa,d(a("input",{type:"text",class:"form-control",id:"alamat",placeholder:"Masukkan alamat","onUpdate:modelValue":t[4]||(t[4]=e=>o.value.alamat=e)},null,512),[[r,o.value.alamat]])]),o.value.type==="hotel"?(b(),f("div",za,[a("div",Ka,[qa,d(a("input",{type:"text",class:"form-control",id:"bintangHotel",placeholder:"Masukkan jumlah kamar","onUpdate:modelValue":t[5]||(t[5]=e=>o.value.bintangHotel=e)},null,512),[[r,o.value.bintangHotel]])]),a("div",Ja,[Oa,d(a("input",{type:"text",class:"form-control",id:"kamarVip",placeholder:"Masukkan jumlah kamar vip","onUpdate:modelValue":t[6]||(t[6]=e=>o.value.kamarVip=e)},null,512),[[r,o.value.kamarVip]])]),a("div",Wa,[Ga,d(a("input",{type:"text",class:"form-control",id:"kamarStandart",placeholder:"Masukkan jumlah kamar standard","onUpdate:modelValue":t[7]||(t[7]=e=>o.value.kamarStandart=e)},null,512),[[r,o.value.kamarStandart]])])])):x("",!0),a("div",Qa,[Xa,d(a("input",{type:"text",class:"form-control",id:"namaPj",placeholder:"Masukkan nama penanggung jawab","onUpdate:modelValue":t[8]||(t[8]=e=>o.value.namaPj=e)},null,512),[[r,o.value.namaPj]])]),a("div",Ya,[Za,d(a("input",{type:"email",class:"form-control",id:"emailPj",placeholder:"Masukkan email penanggung jawab","onUpdate:modelValue":t[9]||(t[9]=e=>o.value.emailPj=e)},null,512),[[r,o.value.emailPj]])]),a("div",ae,[ee,d(a("input",{type:"password",class:"form-control",id:"passwordPj",placeholder:"Masukkan password penanggung jawab","onUpdate:modelValue":t[10]||(t[10]=e=>o.value.passwordPj=e)},null,512),[[r,o.value.passwordPj]])]),a("div",te,[oe,d(a("input",{type:"text",class:"form-control",id:"teleponPj",placeholder:"Masukkan nomor telepon","onUpdate:modelValue":t[11]||(t[11]=e=>o.value.teleponPj=e)},null,512),[[r,o.value.teleponPj]])]),a("div",se,[le,d(a("input",{type:"text",class:"form-control",id:"pendidikanPj",placeholder:"Masukkan pendidikan","onUpdate:modelValue":t[12]||(t[12]=e=>o.value.pendidikanPj=e)},null,512),[[r,o.value.pendidikanPj]])]),a("div",ne,[ie,d(a("input",{type:"text",class:"form-control",id:"nikPj",placeholder:"Masukkan NIK","onUpdate:modelValue":t[13]||(t[13]=e=>o.value.nikPj=e)},null,512),[[r,o.value.nikPj]])]),a("div",de,[re,d(a("input",{type:"text",class:"form-control",id:"wargaNegaraPj",placeholder:"Masukkan warga negara","onUpdate:modelValue":t[14]||(t[14]=e=>o.value.wargaNegaraPj=e)},null,512),[[r,o.value.wargaNegaraPj]])]),a("div",ce,[ue,d(a("input",{type:"text",class:"form-control",id:"koordinat",placeholder:"Masukkan koordinat","onUpdate:modelValue":t[15]||(t[15]=e=>o.value.koordinat=e),disabled:""},null,512),[[r,o.value.koordinat]])]),a("div",pe,[j(aa,{onLocationSelected:H,defaultCoordinate:o.value.koordinat},null,8,["defaultCoordinate"])])])]),a("div",{class:"modal-footer"},[me,a("button",{type:"button",class:"btn btn-primary",onClick:T}," Simpan Perubahan ")])])])])],64))}}),je=M(be,[["__scopeId","data-v-425c25c9"]]);export{je as default};
